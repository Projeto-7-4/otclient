name: ğŸ—ï¸ Build OTClient Windows

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  workflow_dispatch:  # Permite executar manualmente

jobs:
  build-windows:
    runs-on: windows-latest
    
    steps:
    - name: ğŸ“¥ Checkout cÃ³digo
      uses: actions/checkout@v4
      
    - name: ğŸ“¦ Setup vcpkg
      uses: lukka/run-vcpkg@v11
      with:
        vcpkgGitCommitId: 'c8696863d371ab7f46e213d8f5ca923c4aef2a00'
        
    - name: ğŸ”§ Setup CMake e Ninja
      uses: lukka/get-cmake@latest
      
    - name: ğŸ—ï¸ Compilar OTClient
      uses: lukka/run-cmake@v10
      with:
        configurePreset: 'windows-release'
        buildPreset: 'windows-release'
        
    - name: ğŸ“¦ Preparar artefato
      run: |
        mkdir release-package
        copy build\windows-release\otclient.exe release-package\
        copy README_PROJETO74.md release-package\README.md
        
    - name: ğŸ“¤ Upload executÃ¡vel
      uses: actions/upload-artifact@v4
      with:
        name: otclient-windows-x64
        path: release-package/
        retention-days: 90
        
    - name: ğŸ‰ Criar Release (se for tag)
      if: startsWith(github.ref, 'refs/tags/')
      uses: softprops/action-gh-release@v1
      with:
        files: release-package/otclient.exe
        body: |
          ## ğŸ® OTClient - Projeto 7.4
          
          ### âœ¨ OtimizaÃ§Ãµes incluÃ­das:
          - FPS padrÃ£o: 60 (reduz flicker visual)
          - Protocolo 772 estÃ¡vel
          - Compilado para Windows x64
          
          ### ğŸ“¥ Como usar:
          1. Baixe `otclient.exe`
          2. Substitua na pasta do seu OTClient
          3. Configure `init.lua` para conectar em `192.168.0.36:7171:772`
          4. Execute e jogue!
          
          ### ğŸ”§ ConfiguraÃ§Ã£o do servidor:
          ```lua
          Servers = {
              ["Nostalrius 7.72"] = "192.168.0.36:7171:772"
          }
          ```
